openapi: 3.0.0
info:
  title: Reconciliation and Settlement Framework (RSF) for ONDC
  description: ONDC  Reconciliation and Settlement Framework API Specification
  version: 2.0.0
security:
  - SubscriberAuth: []
paths:
  /settle:
    post:
      tags:
        - Settlement Agency
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    collector_app_id:
                      type: string
                    receiver_app_id:
                      type: string
                    settlement:
                      $ref: '#/components/schemas/Settlement'
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
  /on_settle:
    post:
      tags:
        - Collector
        - Receiver
      requestBody:
        description: SA responds with /on_settle
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    collector_app_id:
                      type: string
                    receiver_app_id:
                      type: string
                    settlement:
                      $ref: '#/components/schemas/Settlement'
                  required:
                    - settlement
                error:
                  $ref: '#/components/schemas/Error'
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
  /report:
    post:
      tags:
        - Settlement Agency
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    ref_transaction_id:
                      type: string
                    ref_message_id:
                      type: string
                error:
                  $ref: '#/components/schemas/Error'
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
  /on_report:
    post:
      tags:
        - Collector
        - Receiver
      requestBody:
        description: SA responds with /on_report
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    collector_app_id:
                      type: string
                    receiver_app_id:
                      type: string
                    settlement:
                      $ref: '#/components/schemas/Settlement'
                  required:
                    - settlement
                error:
                  $ref: '#/components/schemas/Error'
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
  /recon:
    post:
      tags:
        - Collector
        - Receiver
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    orders:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            description: Describes the order id
                          amount:
                            $ref: '#/components/schemas/Amount'
                          settlements:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                payment_id:
                                  type: string
                                status:
                                  type: string
                                amount:
                                  $ref: '#/components/schemas/Amount'
                                commision:
                                  $ref: '#/components/schemas/Amount'
                                withholding_amount:
                                  $ref: '#/components/schemas/Amount'
                                tcs:
                                  $ref: '#/components/schemas/Amount'
                                tds:
                                  $ref: '#/components/schemas/Amount'
                                updated_at:
                                  type: string
                                  format: date-time
                                settlement_ref_no:
                                  type: string
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
  /on_recon:
    post:
      tags:
        - Collector
        - Receiver
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                context:
                  $ref: '#/components/schemas/Context'
                message:
                  type: object
                  properties:
                    orders:
                      type: array
                      items:
                        type: object
                        properties:
                          id:
                            type: string
                            description: Describes the order id
                          amount:
                            $ref: '#/components/schemas/Amount'
                          recon_accord:
                            type: boolean
                          settlements:
                            type: array
                            items:
                              type: object
                              properties:
                                id:
                                  type: string
                                payment_id:
                                  type: string
                                status:
                                  type: string
                                amount:
                                  allOf:
                                    - type: object
                                      properties:
                                        diff_value:
                                          type: string
                                    - $ref: '#/components/schemas/Amount'
                                commision:
                                  allOf:
                                    - type: object
                                      properties:
                                        diff_value:
                                          type: string
                                    - $ref: '#/components/schemas/Amount'
                                withholding_amount:
                                  allOf:
                                    - type: object
                                      properties:
                                        diff_value:
                                          type: string
                                    - $ref: '#/components/schemas/Amount'
                                tcs:
                                  allOf:
                                    - type: object
                                      properties:
                                        diff_value:
                                          type: string
                                    - $ref: '#/components/schemas/Amount'
                                tds:
                                  allOf:
                                    - type: object
                                      properties:
                                        diff_value:
                                          type: string
                                    - $ref: '#/components/schemas/Amount'
                                updated_at:
                                  type: string
                                  format: date-time
                                settlement_ref_no:
                                  type: string
              required:
                - context
                - message
      responses:
        '200':
          description: Acknowledgement of message received
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: object
                    properties:
                      ack:
                        $ref: '#/components/schemas/Ack'
                    required:
                      - ack
                  error:
                    $ref: '#/components/schemas/Error'
                required:
                  - message
components:
  securitySchemes:
    SubscriberAuth:
      type: apiKey
      in: header
      name: Authorization
      description: >-
        Signature of message body using Collector or Receiver subscriber's
        signing public key. <br/><br/>Format:<br/><br/><code>Authorization :
        Signature
        keyId="{subscriber_id}|{unique_key_id}|{algorithm}",algorithm="ed25519",created="1606970629",expires="1607030629",headers="(created)
        (expires) digest",signature="Base64(signing string)"</code>
  schemas:
    Ack:
      description: Describes the ACK response
      type: object
      properties:
        status:
          type: string
          description: >-
            Describe the status of the ACK response. If schema validation
            passes, status is ACK else it is NACK
          enum:
            - ACK
            - NACK
    Amount:
      type: object
      properties:
        currency:
          type: string
          example: INR
        value:
          type: string
          example: ''
    BankDetails:
      type: object
      properties:
        account_no:
          type: string
          example: ''
        ifsc_code:
          type: string
          example: ''
    Context:
      description: Describes a beckn message context
      type: object
      properties:
        domain:
          type: string
        location:
          type: object
          properties:
            country:
              type: object
              properties:
                code:
                  type: string
                  example: IND
            city:
              type: object
              properties:
                code:
                  type: string
                  example: '*'
        action:
          type: string
          description: >-
            Defines the Beckn API call. Any actions other than the enumerated
            actions are not supported by Beckn Protocol
        version:
          type: string
          description: Version of Beckn core API specification being used
        bap_id:
          type: string
          description: >-
            Unique id of the BAP. By default it is the fully qualified domain
            name of the BAP
        bap_uri:
          type: string
          format: uri
          description: >-
            URI of the BAP for accepting callbacks. Must have the same domain
            name as the bap_id
        bpp_id:
          type: string
          description: >-
            Unique id of the BPP. By default it is the fully qualified domain
            name of the BPP
        bpp_uri:
          type: string
          format: uri
          description: URI of the BPP. Must have the same domain name as the bap_id
        transaction_id:
          type: string
          description: >-
            This is a unique value which persists across all API calls from
            search through confirm
        message_id:
          type: string
          description: >-
            This is a unique value which persists during a request / callback
            cycle
        timestamp:
          type: string
          format: date-time
          description: Time of request generation in RFC3339 format
        key:
          type: string
          description: The encryption public key of the sender
        ttl:
          type: string
          description: >-
            The duration in ISO8601 format after timestamp for which this
            message holds valid
      required:
        - domain
        - action
        - location
        - version
        - transaction_id
        - message_id
        - bap_id
        - bap_uri
        - timestamp
    Error:
      description: >-
        Describes an error object that is returned by a Collector or Receiver as
        a response or callback to an action by another network participant. This
        object is sent when any request received by a network participant is
        unacceptable. This object can be sent either during Ack or with the
        callback.
      type: object
      properties:
        code:
          type: string
          description: >-
            Standard error code. For full list of error codes, refer <a href =
            https://ondc-official.github.io/ONDC-NTS-Specifications/#error>here</a>
        message:
          type: string
          description: >-
            Human readable message describing the error. Used mainly for
            logging. Not recommended to be shown to the user.
    Orders:
      type: array
      items:
        type: object
        properties:
          id:
            description: Describes the order id
            type: string
          inter_participant:
            description: >-
              Provides details about the settlement amount, payable/ receivable
              and status between the Collector and the Receiver
            type: object
            properties:
              settled_amount:
                $ref: '#/components/schemas/Amount'
              amount:
                $ref: '#/components/schemas/Amount'
              status:
                type: string
                enum:
                  - SETTLED
                  - NOT-SETTLED
              reference_no:
                type: string
              error:
                $ref: '#/components/schemas/Error'
          collector:
            description: Provides details about the amount to be retained by the collector
            type: object
            properties:
              amount:
                $ref: '#/components/schemas/Amount'
          provider:
            description: >-
              Provides details about the amount to be settled to the Provider of
              an NP.
            type: object
            properties:
              id:
                type: string
                example: ''
              name:
                type: string
                example: ''
              bank_details:
                $ref: '#/components/schemas/BankDetails'
              status:
                type: string
                enum:
                  - SETTLED
                  - NOT-SETTLED
              amount:
                $ref: '#/components/schemas/Amount'
              reference_no:
                type: string
              error:
                $ref: '#/components/schemas/Error'
          self:
            type: object
            description: >-
              Provides details about the amount for the NP to move to their
              operative account
            properties:
              amount:
                $ref: '#/components/schemas/Amount'
              status:
                type: string
                enum:
                  - SETTLED
                  - NOT-SETTLED
              reference_no:
                type: string
              error:
                $ref: '#/components/schemas/Error'
    Settlement:
      description: >
        - Describes the settlement of NP -NP - Describes the miscellaneous
        settlement - Describes the NIL settlement
      type: object
      properties:
        type:
          description: Describes the type of the settlement
          type: string
        id:
          description: |
            * settlement id of the settlement file
          type: string
        order:
          $ref: '#/components/schemas/Orders'
x-enum:
  settle:
    context: &ref_0
      location:
        country:
          code:
            - code: IND
              description: Represents the country
        city:
          code:
            - code: '*'
              description: city
      domain:
        - code: ONDC:NTS10
          description: RSF
    message:
      settlement:
        type: &ref_1
          - &ref_3
            code: NP-NP
            description: Interparticipant settlement
          - &ref_4
            code: MISC
            description: Miscellaneous
          - code: NIL
            description: NP Declaring no settlement required
  on_settle:
    context: *ref_0
    message:
      settlement:
        type: *ref_1
        orders: &ref_5
          inter_participant: &ref_2
            status:
              - code: SETTLED
                description: settlement successful
              - code: NOT_SETTLED
                description: settlement unsuccessful
          provider: *ref_2
          self: *ref_2
  on_report:
    context: *ref_0
    message:
      settlement:
        type:
          - *ref_3
          - *ref_4
          - code: NIL
            description: NP declaring no settlement required
        orders: *ref_5
  recon:
    context: *ref_0
    message: &ref_6
      orders:
        settlements:
          status:
            - code: SETTLED
              description: Successfully settled
            - code: PENDING
              description: Settlement awaited due to reconciliation difference between NPs
            - code: TO_BE_INITIATED
              description: Settlement to be initiated in a future settlement cycle
  on_recon:
    context: *ref_0
    message: *ref_6
x-flows:
  - summary: RSF NP-NP
    details:
      - description: >
          Detailed flows covering inter participant settlements. NPs (Collector
          and Receiver) share settlement instructions to the Settlement Agency
          and the settlement agency responds with whether the settlement was
          successful or not.


          In the example below, the collector is a retail seller app and the
          receiver is the retail buyer app. The retail seller app shares
          instructions for receivable for an order from the retail buyer app, to
          be sent to their own operating account (self) and their provider's
          account (provider). The retail buyer app shares instructions for
          payable for the respective order along with funds to be moved to their
          own operating amount (self).
        mermaid: |-
          sequenceDiagram
           participant Collector
            participant Settlement_Agency
           participant Receiver
           Collector ->> Settlement_Agency: settle API 
           Settlement_Agency -->> Collector: ack
           Receiver ->> Settlement_Agency: settle API
           Settlement_Agency -->> Receiver: ack
           Settlement_Agency ->> Collector : on_settle API
           Collector -->> Settlement_Agency: ack
           Settlement_Agency ->> Receiver : on_settle API
           Receiver -->> Settlement_Agency : ack
    references: if any
    steps:
      - summary: SETTLEMENT INSTRUCTIONS
        reference: if any
        api: settle
        example:
          value: &ref_14
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: dc34a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ed9a4-d74d-4411-ac06-469c0f9ac
              timestamp: '2024-05-09T11:36:51.897Z'
              ttl: P1D
            message:
              collector_app_id: collectorapp.com
              receiver_app_id: receiverapp.com
              settlement:
                type: NP-NP
                id: settlement-id-abc
                orders:
                  - id: ordr-123456
                    inter_participant:
                      amount:
                        currency: INR
                        value: '1000.00'
                    collector:
                      amount:
                        currency: INR
                        value: '50.00'
                    provider:
                      id: prvdr-id-789
                      name: Kirana Pvt Ltd
                      bank_details:
                        account_no: '1234567890'
                        ifsc_code: IFSC0001
                      amount:
                        currency: INR
                        value: '800.00'
                    self:
                      amount:
                        currency: INR
                        value: '200.00'
        details:
          - description: settlement instructions from NP to Settlement Agency
            mermaid: |-
              sequenceDiagram participant Collector
               participant Settlement_Agency
               participant Receiver
               rect rgb(191, 223, 255) 
               Collector ->> Settlement_Agency: settle API 
               Settlement_Agency ->> Collector : Ack    
               end
               Receiver ->> Settlement_Agency: settle API     
               Settlement_Agency ->> Collector : on_settle API
               Settlement_Agency ->> Receiver : on_settle API
      - summary: SETTLEMENT INSTRUCTIONS
        reference: if any
        api: settle
        example:
          value: &ref_13
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: dc34a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ed9a4-d74d-4411-ac06-469c0f9ac
              timestamp: '2024-05-09T11:36:51.897Z'
              ttl: P1D
            message:
              collector_app_id: collectorapp.com
              receiver_app_id: receiverapp.com
              settlement:
                type: NP-NP
                id: settlement-id-abc
                orders:
                  - id: ordr-123456
                    inter_participant:
                      amount:
                        currency: INR
                        value: '1000.00'
                    collector:
                      amount:
                        currency: INR
                        value: '50.00'
                    self:
                      amount:
                        currency: INR
                        value: '50.00'
        details:
          - description: settlement instructions from NP to Settlement Agency
            mermaid: |-
              sequenceDiagram participant Collector
               participant Settlement_Agency
               participant Receiver
               Collector ->> Settlement_Agency: settle API 
               rect rgb(191, 223, 255) 
               Receiver ->> Settlement_Agency: settle API
               Settlement_Agency ->> Receiver :Ack
               end
               Settlement_Agency ->> Collector : on_settle API
               Settlement_Agency ->> Receiver : on_settle API
      - summary: SETTLEMENT RESPONSE
        reference: if any
        api: on_settle
        example:
          value: &ref_9
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.in/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: dc34a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ed9a4-d74d-4411-ac06-469c0f9ac
              timestamp: '2024-05-09T13:36:51.000Z'
              ttl: P1D
            message:
              collector_app_id: collectorapp.com
              receiver_app_id: receiverapp.com
              settlement:
                type: NP-NP
                id: settlement-id-abc
                orders:
                  - id: ordr-123456
                    inter_participant:
                      settled_amount:
                        currency: INR
                        value: '1000.00'
                      amount:
                        currency: INR
                        value: '1000.12'
                      status: SETTLED
                      reference_no: '3245683618631'
                    collector:
                      amount:
                        currency: INR
                        value: '50.00'
                    provider:
                      id: prvdr-id-789
                      amount:
                        currency: INR
                        value: '800.00'
                      status: NOT-SETTLED
                      error:
                        code: '01'
                        message: Account inactive
                      reference_no: '1238683618634'
                    self:
                      amount:
                        currency: INR
                        value: '200.00'
                      status: NOT-SETTLED
                      reference_no: '1238683618634'
                      error:
                        code: '01'
                        message: Account inactive
        details:
          - description: Response from settlement agency
            mermaid: |-
              sequenceDiagram participant Collector
               participant Settlement_Agency
               participant Receiver
               Collector ->> Settlement_Agency: settle API 
               Receiver ->> Settlement_Agency: settle API
               rect rgb(191, 223, 255) 
               Settlement_Agency ->> Collector : on_settle API
               Collector ->> Settlement_Agency: Ack
               end
               Settlement_Agency ->> Receiver : on_settle API
      - summary: SETTLEMENT RESPONSE
        reference: if any
        api: on_settle
        example:
          value: &ref_8
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.in/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: dc34a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ed9a4-d74d-4411-ac06-469c0f9ac
              timestamp: '2024-05-09T13:36:51.000Z'
              ttl: P1D
            message:
              collector_app_id: collectorapp.com
              receiver_app_id: receiverapp.com
              settlement:
                type: NP-NP
                id: settlement-id-abc
                orders:
                  - id: ordr-123456
                    inter_participant:
                      settled_amount:
                        currency: INR
                        value: '1000.00'
                      amount:
                        currency: INR
                        value: '1000.12'
                      status: SETTLED
                      reference_no: '3245683618631'
                    collector:
                      amount:
                        currency: INR
                        value: '50.00'
                    self:
                      amount:
                        currency: INR
                        value: '50.00'
                      status: SETTLED
                      reference_no: '1238683618634'
        details:
          - description: Response from settlement agency
            mermaid: |-
              sequenceDiagram participant Collector
               participant Settlement_Agency
               participant Receiver
               Collector ->> Settlement_Agency: settle API 
               Receiver ->> Settlement_Agency: settle API
               Settlement_Agency ->> Collector : on_settle API
               rect rgb(191, 223, 255) 
               Settlement_Agency ->> Receiver : on_settle API
               Receiver ->> Settlement_Agency: Ack
               end
  - summary: RSF MISC
    details:
      - description: >-
          Detailed flows covering miscellaneous or self settlements.  NPs share
          settlement instructions to the Settlement Agency  and the settlement
          agency responds with whether the settlement  was successful or not. In
          the example below, a retail seller app is sharing settlement
          instructions to move funds from their non operating account to their
          operating account and their respective provider's account.
        mermaid: |-
          sequenceDiagram
           participant NP
           participant Settlement_Agency
           NP ->> Settlement_Agency: settle API 
           Settlement_Agency ->> NP : on_settle API
    references: if any
    steps:
      - summary: SETTLE
        api: settle
        details:
          - description: settle api
            mermaid: |-
              sequenceDiagram participant NP
               participant Settlement_Agency
              NP ->> Settlement_Agency: settle API 
               Settlement_Agency ->> NP : on_settle API
        reference: if any
        example:
          value: &ref_15
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: ad73a366-aebb-4144-9314-808dda82c8e6
              message_id: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T09:32:23.600Z'
              ttl: P1D
            message:
              settlement:
                type: MISC
                id: settlement-id-123
                orders:
                  - self:
                      amount:
                        currency: INR
                        value: '200.00'
      - summary: ON_SETTLE
        api: on_settle
        details:
          - description: on_settle
            mermaid: |-
              sequenceDiagram participant NP
               participant Settlement_Agency
              NP ->> Settlement_Agency: settle API 
               Settlement_Agency ->> NP : on_settle API
        reference: if any
        example:
          value: &ref_10
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: ad73a366-aebb-4144-9314-808dda82c8e6
              message_id: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T09:32:23.623Z'
              ttl: PT30S
            message:
              settlement:
                type: MISC
                id: settlement-id-123
                orders:
                  - self:
                      amount:
                        currency: INR
                        value: '200.00'
                      status: SETTLED
                      reference_no: '3718683618631'
  - summary: RSF NIL
    details:
      - description: >-
          Detailed flows covering the NPs declaring that no settlements (where
          they would act as a collector) are to be done for that settlement
          cycle.
        mermaid: |-
          sequenceDiagram
           participant NP(Collector/Receiver)
           participant Settlement_Agency
           NP(Collector/Receiver) ->> Settlement_Agency: settle API 
           Settlement_Agency ->> NP(Collector/Receiver) : on_settle API
    references: if any
    steps:
      - summary: SETTLE
        api: settle
        details:
          - description: settle api
            mermaid: |-
              sequenceDiagram participant NP(Collector/Receiver)
                participant Settlement_Agency
                NP(Collector/Receiver) ->> Settlement_Agency: settle API      
                Settlement_Agency ->> NP(Collector/Receiver) : on_settle API
        reference: if any
        example:
          value: &ref_16
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: settle
              bap_id: collectorapp.com
              bap_uri: https://collector.in/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa.nbbl.nbbl.com/nocs_test
              transaction_id: de73a489-aebb-4144-9314-808dda82c7e6
              message_id: 238ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T08:40:50.900Z'
              ttl: P1D
            message:
              settlement:
                type: NIL
      - summary: ON_SETTLE
        api: on_settle
        details:
          - description: on_settle
            mermaid: |-
              sequenceDiagram participant NP
               participant Settlement_Agency
               NP ->> Settlement_Agency: settle API 
               Settlement_Agency ->> NP : on_settle API
        reference: if any
        example:
          value: &ref_11
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_settle
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: de73a489-aebb-4144-9314-808dda82c7e6
              message_id: 238ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T08:40:51.000Z'
              ttl: P1D
            message:
              settlement:
                type: NIL
  - summary: RSF REPORT
    details:
      - description: >-
          Detailed flows covering NPs seeking status of a settlement
          instructions previously shared with reference to a transaction id and/
          or message id. The settlement agency responds with the status of the
          respective settlement instructions referred.
        mermaid: |-
          sequenceDiagram
           participant NP
           participant Settlement_Agency
           NP ->> Settlement_Agency: report API 
           Settlement_Agency ->> NP : on_report API
    references: if any
    steps:
      - summary: REPORT
        api: report
        details:
          - description: report api
            mermaid: |-
              sequenceDiagram
               participant NP
               participant Settlement_Agency      
               NP ->> Settlement_Agency: report API 
               Settlement_Agency ->> NP : ACK
               Settlement_Agency ->> NP : on_report API
               NP ->> Settlement_Agency : Ack
        reference: if any
        example:
          value: &ref_12
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: report
              bap_id: collectorapp.com
              bap_uri: https://collector.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://nbbl.org.in/nocs_test
              transaction_id: cd73a366-aebb-4144-9314-808dda82c7e6
              message_id: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-09T06:36:51.897Z'
              ttl: P1D
            message:
              ref_transaction_id: bd73a366-aebb-4144-9314-808dda82c7e6
              ref_message_id: 941ef6d7-d74d-4411-ac06-469c0f9ac
      - summary: ON_REPORT
        api: on_report
        details:
          - description: on_report
            mermaid: |-
              sequenceDiagram
               participant NP
               participant Settlement_Agency
               NP ->> Settlement_Agency: report API  
               Settlement_Agency ->> NP : Ack
               Settlement_Agency ->> NP : on_ report API
               NP ->> Settlement_Agency : Ack
        reference: if any
        example:
          value: &ref_7
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_report
              bap_id: collectorapp.com
              bap_uri: https://collectorapp.com/ondc/1.0/
              bpp_id: sa_nocs.nbbl.com
              bpp_uri: https://sa_nocs.nbbl.com/nocs_test
              transaction_id: cd73a366-aebb-4144-9314-808dda82c7e6
              message_id: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T06:36:51.900Z'
              ttl: P1D
            message:
              collector_app_id: collectorapp.com
              receiver_app_id: receiverapp.com
              settlement:
                type: NP-NP
                id: settlement-id-123
                orders:
                  - id: order-id-456
                    inter_participant:
                      settled_amount:
                        currency: INR
                        value: '1000.00'
                      amount:
                        currency: INR
                        value: '1000.27'
                      status: SETTLED
                      reference_no: '3718683618631'
                      error:
                        code: '01'
                        message: Account Inactive
                    collector:
                      amount:
                        currency: INR
                        value: '50.00'
                    provider:
                      id: provider-id-789
                      amount:
                        currency: INR
                        value: '800.00'
                      status: NOT-SETTLED
                      error:
                        code: '01'
                        message: Account Inactive
                      reference_no: '3718683618634'
                    self:
                      amount:
                        currency: INR
                        value: '200.00'
                      status: NOT-SETTLED
                      reference_no: '3718683618634'
                      error:
                        code: '01'
                        message: Account inactive
  - summary: RSF RECON
    details:
      - description: >-
          The reconciliation process among the NPs are facilitated through the
          recon and on_recon APIs. In case settlement instructions are shared to
          the settlement agency and it fails for certain orders due an order
          mismatch or an order amount mismatch, NPs shall leverage the recon and
          on_recon API to communicate the mismatches. <br> In case an NP
          receives an order amount mismatch error code from the settlement
          agency, the receiver initiates the /recon request to the collector
          providing the breakup details for the respective order ID(s). The
          collector then reconciles and responds with the on_recon including the
          difference amount. <br>  In case an NP receives an order id mismatch
          error code (i.e. order ID not shared by the counterparty), the NP is
          expected to call the /recon API of the respective counterparty with
          the specific order ID(s) and its breakup details. The counterparty
          then reconciles and responds with details specific to the order id
          requested. <br> In both cases, if the response is correctly reconciled
          for the requisite orders, the settlement is initiated in the next
          settlement cycle. Otherwise, NPs are expected to raise an IGM for
          resolving the differences.
        mermaid: |-
          sequenceDiagram
           participant Collector
           participant Receiver
           Receiver ->> Collector : /recon API
           Collector ->> Receiver: /on_recon API
    references: if any
    steps:
      - summary: RECON
        api: recon
        details:
          - description: /recon
            mermaid: |-
              sequenceDiagram
               participant Collector
               participant Receiver
               Receiver ->> Collector : /recon API
               Collector ->> Receiver: /on_recon API
        reference: if any
        example:
          value:
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: recon
              bap_id: collector-app.com
              bap_uri: https://collector-app.com/ondc/1.0/
              bpp_id: receiver-app.com
              bpp_uri: https://receiver-app.com/ondc/
              transaction_id: bd73a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T06:36:51.897Z'
              ttl: P1D
            message:
              orders:
                - id: order-1234
                  amount:
                    currency: INR
                    value: '300.00'
                  settlements:
                    - id: settlement-id-456
                      payment_id: pymnt-1
                      status: PENDING
                      amount:
                        currency: INR
                        value: '100.00'
                      commission:
                        currency: INR
                        value: '10.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                      tcs:
                        currency: INR
                        value: '10.00'
                      tds:
                        currency: INR
                        value: '10.00'
                      updated_at: '2024-05-07T07:36:51.897Z'
                    - id: settlement-id-789
                      payment_id: pymnt-2
                      status: SETTLED
                      amount:
                        currency: INR
                        value: '100.00'
                      commission:
                        currency: INR
                        value: '10.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                      gst_amount:
                        currency: INR
                        value: '10.00'
                      tds_amount:
                        currency: INR
                        value: '10.00'
                      settlement_ref_no: utr-1234
                      updated_at: '2024-05-07T06:36:51.897Z'
                    - id: settlement-id-112
                      payment_id: pymnt-3
                      status: TO-BE-INITIATED
                      amount:
                        currency: INR
                        value: '100.00'
                      commission:
                        currency: INR
                        value: '10.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                      gst_amount:
                        currency: INR
                        value: '10.00'
                      tds_amount:
                        currency: INR
                        value: '10.00'
                      updated_at: '2024-05-07T06:36:51.897Z'
      - summary: ON_RECON
        api: on_recon
        details:
          - description: /on_recon
            mermaid: |-
              sequenceDiagram
               participant Collector
               participant Receiver
               Receiver ->> Collector : /recon API
               Collector ->> Receiver: /on_recon API
        reference: if any
        example:
          value:
            context:
              domain: ONDC:NTS10
              location:
                country:
                  code: IND
                city:
                  code: '*'
              version: 2.0.0
              action: on_recon
              bap_id: collector-app.com
              bap_uri: https://collector-app.com/ondc/1.0/
              bpp_id: receiver-app.com
              bpp_uri: https://receiver-app.com/ondc/
              transaction_id: bd73a366-aebb-4144-9314-808dda82c7e6
              message_id: 941ef6d7-d74d-4411-ac06-a05469c0f9ac
              timestamp: '2024-05-07T06:36:51.897Z'
              ttl: P1D
            message:
              orders:
                - id: order-1234
                  amount:
                    currency: INR
                    value: '300.00'
                  recon_accord: true
                  settlements:
                    - id: settlement-id-456
                      payment_id: pymnt-1
                      status: PENDING
                      amount:
                        currency: INR
                        value: '100.00'
                        diff_value: '10.00'
                      commission:
                        currency: INR
                        value: '10.00'
                        diff_value: '0.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                        diff_value: '0.00'
                      tcs:
                        currency: INR
                        value: '10.00'
                        diff_value: '5.00'
                      tds:
                        currency: INR
                        value: '10.00'
                        diff_value: '5.00'
                      updated_at: '2024-05-07T07:36:51.897Z'
                    - id: settlement-id-789
                      payment_id: pymnt-2
                      status: SETTLED
                      amount:
                        currency: INR
                        value: '100.00'
                      commission:
                        currency: INR
                        value: '10.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                      gst_amount:
                        currency: INR
                        value: '10.00'
                      tds_amount:
                        currency: INR
                        value: '10.00'
                      settlement_ref_no: utr-1234
                      updated_at: '2024-05-07T06:36:51.897Z'
                    - id: settlement-id-112
                      payment_id: pymnt-3
                      status: TO-BE-INITIATED
                      amount:
                        currency: INR
                        value: '100.00'
                      commission:
                        currency: INR
                        value: '10.00'
                      withholding_amount:
                        currency: INR
                        value: '10.00'
                      gst_amount:
                        currency: INR
                        value: '10.00'
                      tds_amount:
                        currency: INR
                        value: '10.00'
                      updated_at: '2024-05-07T06:36:51.897Z'
x-examples:
  RSF:
    summary: RSF 2.0
    description: >
      Reconciliation and Settlement Framework provides a comprehensive framework

      to ensure accurate and timely settlements among participants in the
      network.

      RSF 2.0 brings an enhanced workflow where the NPs share order-level the

      settlement instructions to the Settlement Agency (SA) which matches the
      same

      with the respective counterparty NP and then moves funds if the amounts
      have

      matched successfully. 


      Explainer & BRD is documented <a href =
      "https://docs.google.com/document/d/1IXZuqTCfEzBxdHJKzHVZ9kPm_lYk5DxjdaQ25--YH8M/edit#heading=h.7edkggo8m4oc">here</a>


      Functional flows and use cases are documented <a href =
      "https://docs.google.com/document/d/1Pj7e1MuObQeLczx_palbcliUPTkMRYA76esjrfAMT14/edit?usp=sharing">here</a>


      For development of funds settlement flow for integration with settlement
      agency, refer settle/on_settle and report/on_report API specs below


      For development of reconciliation flow amongst network participants, refer
      recon/on_recon API specs below
    example_set:
      on_report:
        examples:
          - summary: on_report
            description: Response from settlement agency
            value: *ref_7
      on_settle:
        examples:
          - summary: on_settle np_np
            description: callback response for NP-NP settlement instruction
            value: *ref_8
          - summary: on_settle np-np (with provider)
            value: *ref_9
          - summary: on_settle misc
            description: callback response for Misc / self settlement instruction
            value: *ref_10
          - summary: on_settle misc (with provider)
            value:
              context:
                domain: ONDC:NTS10
                location:
                  country:
                    code: IND
                  city:
                    code: '*'
                version: 2.0.0
                action: on_settle
                bap_id: collectorapp.com
                bap_uri: https://collectorapp.com/ondc/1.0/
                bpp_id: sa_nocs.nbbl.com
                bpp_uri: https://sa_nocs.nbbl.com/nocs_test
                transaction_id: ad73a366-aebb-4144-9314-808dda82c8e6
                message_id: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
                timestamp: '2024-05-07T09:32:23.623Z'
                ttl: PT30S
              message:
                settlement:
                  type: MISC
                  id: settlement-id-123
                  orders:
                    - provider:
                        id: provider-id-789
                        amount:
                          currency: INR
                          value: '200.12'
                        status: NOT-SETTLED
                        reference_no: '3718683618631'
                        error:
                          code: '01'
                          message: Account inactive
                      self:
                        amount:
                          currency: INR
                          value: '200.00'
                        status: SETTLED
                        reference_no: '3718683618631'
          - summary: on_settle nil
            value: *ref_11
      report:
        examples:
          - summary: report
            value: *ref_12
      settle:
        examples:
          - summary: settle np_np
            description: settlement instructions from NP to Settlement Agency
            value: *ref_13
          - summary: settle np-np (with provider)
            value: *ref_14
          - summary: settle misc
            description: Miscellaneous / self settlement instruction
            value: *ref_15
          - summary: settle misc (with provider)
            description: Miscellaneous / self settlement instruction
            value:
              context:
                domain: ONDC:NTS10
                location:
                  country:
                    code: IND
                  city:
                    code: '*'
                version: 2.0.0
                action: settle
                bap_id: collectorapp.com
                bap_uri: https://collectorapp.com/ondc/1.0/
                bpp_id: sa_nocs.nbbl.com
                bpp_uri: https://sa_nocs.nbbl.com/nocs_test
                transaction_id: ad73a366-aebb-4144-9314-808dda82c8e6
                message_id: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
                timestamp: '2024-05-07T09:32:23.600Z'
                ttl: P1D
              message:
                settlement:
                  type: MISC
                  id: settlement-id-123
                  orders:
                    - self:
                        amount:
                          currency: INR
                          value: '200.00'
                      provider:
                        id: provider-id-789
                        name: Kirana Pvt Ltd.
                        bank_details:
                          account_no: '1234567890'
                          ifsc_code: IFSC0001
                        amount:
                          currency: INR
                          value: '200.00'
          - summary: settle nil
            value: *ref_16
x-attributes:
  RSF:
    attribute_set:
      settle_misc:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: settle
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: ad73a366-aebb-4144-9314-808dda82c8e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-07T09:32:23.600Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: MISC
            id:
              required: true
              type: string
              owner: any
              usage: settlement-id-123
            orders:
              self:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
              provider:
                id:
                  required: true
                  type: string
                  owner: any
                  usage: provider-id-789
                name:
                  required: true
                  type: string
                  owner: any
                  usage: Kirana Pvt Ltd.
                bank_details:
                  account_no:
                    required: true
                    type: string
                    owner: any
                    usage: 1234567890
                  ifsc_code:
                    required: true
                    type: string
                    owner: any
                    usage: IFSC0001
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
      settle_np-np:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: settle
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: ad73a366-aebb-4144-9314-808dda82c8e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-07T09:32:23.600Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          collector_app_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          receiver_app_id:
            required: true
            type: string
            owner: any
            usage: receiverapp.com
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: NP-NP
            id:
              required: true
              type: string
              owner: any
              usage: settlement-id-abc
            orders:
              self:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
              provider:
                id:
                  required: true
                  type: string
                  owner: any
                  usage: prvdr-id-789
                name:
                  required: true
                  type: string
                  owner: any
                  usage: Kirana Pvt Ltd
                bank_details:
                  account_no:
                    required: true
                    type: string
                    owner: any
                    usage: '1234567890'
                  ifsc_code:
                    required: true
                    type: string
                    owner: any
                    usage: IFSC0001
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '800.00'
              id:
                required: true
                type: string
                owner: any
                usage: ordr-123456
              inter_participant:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '1000.00'
              collector:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '50.00'
      settle_nil:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: settle
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: ad73a366-aebb-4144-9314-808dda82c8e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-07T09:32:23.600Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: NIL
      on_settle:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: on_settle
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: ad73a366-aebb-4144-9314-808dda82c8e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 354ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-07T09:32:23.600Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          collector_app_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          receiver_app_id:
            required: true
            type: string
            owner: any
            usage: receiverapp.com
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: NP-NP
            id:
              required: true
              type: string
              owner: any
              usage: settlement-id-abc
            orders:
              self:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '1238683618634'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              provider:
                id:
                  required: true
                  type: string
                  owner: any
                  usage: prvdr-id-789
                name:
                  required: true
                  type: string
                  owner: any
                  usage: Kirana Pvt Ltd
                bank_details:
                  account_no:
                    required: true
                    type: string
                    owner: any
                    usage: '1234567890'
                  ifsc_code:
                    required: true
                    type: string
                    owner: any
                    usage: IFSC0001
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '800.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              id:
                required: true
                type: string
                owner: any
                usage: ordr-123456
              inter_participant:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '1000.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              collector:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '50.00'
      report:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: report
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: d73a366-aebb-4144-9314-808dda82c7e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-09T06:36:51.897Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          collector_app_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          receiver_app_id:
            required: true
            type: string
            owner: any
            usage: receiverapp.com
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: NP-NP
            id:
              required: true
              type: string
              owner: any
              usage: settlement-id-abc
            orders:
              self:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '1238683618634'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              provider:
                id:
                  required: true
                  type: string
                  owner: any
                  usage: prvdr-id-789
                name:
                  required: true
                  type: string
                  owner: any
                  usage: Kirana Pvt Ltd
                bank_details:
                  account_no:
                    required: true
                    type: string
                    owner: any
                    usage: '1234567890'
                  ifsc_code:
                    required: true
                    type: string
                    owner: any
                    usage: IFSC0001
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '800.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              id:
                required: true
                type: string
                owner: any
                usage: ordr-123456
              inter_participant:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '1000.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              collector:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '50.00'
          ref_transaction_id:
            required: true
            type: string
            owner: any
            usage: bd73a366-aebb-4144-9314-808dda82c7e6
          ref_message_id:
            required: true
            type: string
            owner: any
            usage: 941ef6d7-d74d-4411-ac06-469c0f9ac
      on_report:
        context:
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
          action:
            required: true
            type: string
            owner: any
            usage: on_report
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: sa_nocs.nbbl.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://sa_nocs.nbbl.com/nocs_test
          transaction_id:
            required: true
            type: string
            owner: any
            usage: cd73a366-aebb-4144-9314-808dda82c7e6
          message_id:
            required: true
            type: string
            owner: any
            usage: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-07T06:36:51.900Z'
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
        message:
          collector_app_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          receiver_app_id:
            required: true
            type: string
            owner: any
            usage: receiverapp.com
          settlement:
            type:
              required: true
              type: string
              owner: any
              usage: NP-NP
            id:
              required: true
              type: string
              owner: any
              usage: settlement-id-123
            orders:
              self:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '200.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              provider:
                id:
                  required: true
                  type: string
                  owner: any
                  usage: provider-id-789
                name:
                  required: true
                  type: string
                  owner: any
                  usage: Kirana Pvt Ltd
                bank_details:
                  account_no:
                    required: true
                    type: string
                    owner: any
                    usage: '1234567890'
                  ifsc_code:
                    required: true
                    type: string
                    owner: any
                    usage: IFSC0001
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '800.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: NOT-SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
              id:
                required: true
                type: string
                owner: any
                usage: order-id-456
              inter_participant:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '1000.00'
                status:
                  required: true
                  type: string
                  owner: any
                  usage: SETTLED
                reference_no:
                  required: true
                  type: string
                  owner: any
                  usage: '3718683618631'
                error:
                  code:
                    required: true
                    type: string
                    owner: any
                    usage: '01'
                  message:
                    required: true
                    type: string
                    owner: any
                    usage: Account inactive
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '1000.00'
              collector:
                amount:
                  currency:
                    required: true
                    type: string
                    owner: any
                    usage: INR
                  value:
                    required: true
                    type: string
                    owner: any
                    usage: '50.00'
          ref_transaction_id:
            required: true
            type: string
            owner: any
            usage: bd73a366-aebb-4144-9314-808dda82c7e6
          ref_message_id:
            required: true
            type: string
            owner: any
            usage: 941ef6d7-d74d-4411-ac06-469c0f9ac
      recon:
        context:
          action:
            required: true
            type: string
            owner: any
            usage: recon
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: receiver-app.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://receiver-app.com/ondc/
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
          message_id:
            required: true
            type: string
            owner: any
            usage: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-09T06:36:51.897Z'
          transaction_id:
            required: true
            type: string
            owner: any
            usage: d73a366-aebb-4144-9314-808dda82c7e6
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
        message:
          orders:
            amount:
              currency:
                required: true
                type: string
                owner: any
                usage: INR
              value:
                required: true
                type: string
                owner: any
                usage: '300.00'
            id:
              required: true
              type: string
              owner: any
              usage: order-1234
            settlements:
              amount:
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
              commission:
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
              id:
                required: true
                type: string
                owner: any
                usage: settlement-id-456
              payment_id:
                required: true
                type: string
                owner: any
                usage: pymnt-1
              settlement_ref_no:
                required: false
                type: string
                owner: any
                usage: utr-1234
              status:
                required: true
                type: string
                owner: any
                usage: PENDING
              tcs:
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
              tds:
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
              updated_at:
                required: true
                type: string
                owner: any
                usage: '2024-05-09T06:36:51.897Z'
              withholding_amount:
                currency:
                  required: true
                  type: string
                  owner: any
                  usage: INR
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
      on_recon:
        context:
          action:
            required: true
            type: string
            owner: any
            usage: on_recon
          bap_id:
            required: true
            type: string
            owner: any
            usage: collectorapp.com
          bap_uri:
            required: true
            type: string
            owner: any
            usage: https://collectorapp.com/ondc/1.0/
          bpp_id:
            required: true
            type: string
            owner: any
            usage: receiver-app.com
          bpp_uri:
            required: true
            type: string
            owner: any
            usage: https://receiver-app.com/ondc/
          domain:
            required: true
            type: string
            owner: any
            usage: ONDC:NTS10
          location:
            city:
              code:
                required: true
                type: string
                owner: any
                usage: '*'
            country:
              code:
                required: true
                type: string
                owner: any
                usage: IND
          message_id:
            required: true
            type: string
            owner: any
            usage: 841ef6d7-d74d-4411-ac06-a05469c0f9ac
          timestamp:
            required: true
            type: string
            owner: any
            usage: '2024-05-09T06:36:51.897Z'
          transaction_id:
            required: true
            type: string
            owner: any
            usage: d73a366-aebb-4144-9314-808dda82c7e6
          ttl:
            required: true
            type: string
            owner: any
            usage: P1D
          version:
            required: true
            type: string
            owner: any
            usage: 2.0.0
        message:
          orders:
            amount:
              currency:
                required: true
                type: string
                owner: any
                usage: INR
              value:
                required: true
                type: string
                owner: any
                usage: '300.00'
            id:
              required: true
              type: string
              owner: any
              usage: order-1234
            recon_accord:
              required: true
              type: boolean
              owner: any
              usage: true
            settlements:
              amount:
                currency:
                  required: false
                  type: string
                  owner: any
                  usage: '10.00'
                diff_amount:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
                value:
                  required: true
                  type: string
                  owner: any
                  usage: INR
              commission:
                currency:
                  required: false
                  type: string
                  owner: any
                  usage: '10.00'
                diff_amount:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
                value:
                  required: true
                  type: string
                  owner: any
                  usage: settlement-id-456
              id:
                required: true
                type: string
                owner: any
                usage: pymnt-1
              payment_id:
                required: false
                type: string
                owner: any
                usage: utr-1234
              settlement_ref_no:
                required: true
                type: string
                owner: any
                usage: PENDING
              status:
                required: true
                type: string
                owner: any
                usage: INR
              tcs:
                currency:
                  required: false
                  type: string
                  owner: any
                  usage: '10.00'
                diff_amount:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
                value:
                  required: true
                  type: string
                  owner: any
                  usage: INR
              tds:
                currency:
                  required: false
                  type: string
                  owner: any
                  usage: '10.00'
                diff_amount:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
                value:
                  required: true
                  type: string
                  owner: any
                  usage: '2024-05-09T06:36:51.897Z'
              updated_at:
                required: true
                type: string
                owner: any
                usage: INR
              withholding_amount:
                currency:
                  required: false
                  type: string
                  owner: any
                  usage: '10.00'
                diff_amount:
                  required: true
                  type: string
                  owner: any
                  usage: '300.00'
                value:
                  required: false
                  type: false
                  owner: false
                  usage: false
x-errorcodes:
  code:
    - Event: NACK
      Description: Invalid Signature
      From: Any
      code: 70000
    - Event: NACK
      Description: Missing mandatory 'Authorization' header param
      From: Any
      code: 70001
    - Event: NACK
      Description: Invalid schema
      From: Any
      code: 70002
    - Event: OnSettle
      Description: Invalid bap id
      From: Any
      code: 70003
    - Event: OnSettle
      Description: Inactive bap id
      From: Any
      code: 70004
    - Event: OnSettle
      Description: Invalid bpp id
      From: Any
      code: 70005
    - Event: OnSettle
      Description: Duplicate transaction id
      From: Any
      code: 70006
    - Event: OnSettle
      Description: Duplicate message id
      From: Any
      code: 70007
    - Event: OnSettle
      Description: Duplicate settlement id
      From: Any
      code: 70008
    - Event: OnSettle
      Description: Bap id doesn't match collector app id or receiver app id
      From: Any
      code: 70009
    - Event: OnSettle
      Description: Collector account not available
      From: Any
      code: 70010
    - Event: OnSettle
      Description: Invalid collector app id
      From: Any
      code: 70011
    - Event: OnSettle
      Description: Inactive collector app id
      From: Any
      code: 70012
    - Event: OnSettle
      Description: Invalid receiver app id
      From: Any
      code: 70013
    - Event: OnSettle
      Description: Inactive receiver app id
      From: Any
      code: 70014
    - Event: OnSettle
      Description: Receiver app id same as Collector app id
      From: Any
      code: 70015
    - Event: OnSettle
      Description: Duplicate order id
      From: Any
      code: 70016
    - Event: OnSettle
      Description: Collector account inoperable
      From: Any
      code: 70017
    - Event: OnSettle
      Description: Receiver account inoperable
      From: Any
      code: 70018
    - Event: OnSettle
      Description: No response from bank for collector account
      From: Any
      code: 70019
    - Event: OnSettle
      Description: No response from bank for receiver account
      From: Any
      code: 70020
    - Event: OnSettle
      Description: No file shared by counterparty
      From: Any
      code: 70021
    - Event: OnSettle
      Description: Order id not shared by counterparty
      From: Any
      code: 70022
    - Event: OnSettle
      Description: Collector value mismatch
      From: Any
      code: 70023
    - Event: OnSettle
      Description: Interparticipant value mismatch
      From: Any
      code: 70024
    - Event: OnSettle
      Description: Insufficient balance in collector account
      From: Any
      code: 70025
    - Event: OnSettle
      Description: Collector NDC breach
      From: Any
      code: 70026
    - Event: OnSettle
      Description: Collector bank NDC breach
      From: Any
      code: 70027
    - Event: https error
      Description: Internal server error
      From: Any
      code: 503
